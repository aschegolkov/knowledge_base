1. SYN scan (-sS)
Когда ты выполняешь сканирование с использованием флага -sS, это SYN-сканирование. Эта техника называется также "half-open scan" или "stealth scan" (сканирование с "половинным" открытием). Основная идея SYN-сканирования в том, чтобы не завершать полноценное TCP-соединение, что позволяет скрыть факт сканирования.

Как это работает:

Nmap отправляет SYN-пакет (запрос на начало соединения) на порт целевой системы.

Если порт открыт, целевая система отвечает SYN-ACK (подтверждение готовности к соединению).

Но вместо того, чтобы завершить установку соединения (которое обычно происходит с помощью флага ACK), Nmap не отправляет окончательное подтверждение (ACK) и закрывает соединение (отсылает RST — reset-пакет).

Почему это полезно:

Сканирование через SYN не завершает TCP-соединение. Это делает его более скрытным и менее заметным для систем мониторинга, так как они могут не зафиксировать, что установлено полное TCP-соединение.

Это также гораздо быстрее, чем обычное сканирование, потому что не требует полного установления и завершения TCP-сессии.

Пример команды:

bash
Копировать
nmap -sS 192.168.1.1
2. TCP Connect scan (-sT)
Это более простая техника сканирования, в отличие от SYN-сканирования. Когда ты выполняешь TCP Connect scan, Nmap пытается установить полноценное TCP-соединение с целевым портом.

Как это работает:

Nmap отправляет SYN-пакет на целевой порт.

Если порт открыт, целевая система ответит SYN-ACK.

Nmap завершит соединение, отправив ACK-пакет, что приведет к установлению полноценного TCP-соединения.

После установления соединения, Nmap немедленно разрывает соединение, отправив FIN или RST для завершения сеанса.

Почему это полезно:

Этот метод надежно проверяет доступность порта, но он также более "громкий" и легче обнаруживаем, поскольку фактически завершает полный TCP-хендшейк (соединение).

Этот метод не скрытный, так как фактически устанавливает соединение с портом, а значит, целевая система может зарегистрировать попытку подключения.

Пример команды:

bash
Копировать
nmap -sT 192.168.1.1
Когда использовать:

Если SYN-сканирование блокируется брандмауэром или системой мониторинга, TCP Connect может быть единственным доступным вариантом.

3. UDP Scan (-sU)
В отличие от TCP, протокол UDP не использует процесс установления соединения (как в случае с TCP). Это делает UDP-сканирование немного сложнее, поскольку не существует такой явной реакции, как SYN-ACK для открытого порта. Вместо этого Nmap анализирует ответы или отсутствие ответа для определения состояния порта.

Как это работает:

Nmap отправляет UDP-пакет на целевой порт.

Если порт открыт, система может не ответить или вернуть ICMP-ответ "Destination Unreachable" в случае, если порт закрыт.

Если порт закрыт, цель обычно отправляет ICMP-сообщение "Destination Unreachable" или UDP-port unreachable.

Если порт фильтруется (например, через брандмауэр), может не быть ответа, и Nmap может классифицировать порт как "filtered".

Почему это полезно:

UDP-сканирование более сложное, поскольку нет явного подтверждения, как в TCP, и может потребовать больше времени для анализа.

Оно полезно для поиска открытых UDP-портов, например, для служб DNS, SNMP, DHCP и т.д.

Пример команды:

bash
Копировать
nmap -sU 192.168.1.1
4. Агрессивное сканирование (-A)
Если хочешь получить больше информации о цели, можешь использовать флаг -A, который включает агрессивное сканирование. Он включает в себя несколько различных техник, таких как:

Сканирование операционной системы (OS detection)

Определение версий сервисов

Сканирование на наличие уязвимостей

Трассировка маршрута (Traceroute)

Пример:

bash
Копировать
nmap -A 192.168.1.1
5. Прочие полезные флаги для сканирования
-p: Указывает порты для сканирования. Пример:

bash
Копировать
nmap -p 80,443 192.168.1.1
-T: Настройка тайминга, где:

-T0 — очень медленное сканирование (для избегания обнаружения)

-T4 — достаточно агрессивное сканирование, подходящее для быстрой проверки Пример:

bash
Копировать
nmap -T4 192.168.1.1
-O: Определение операционной системы. Пример:

bash
Копировать
nmap -O 192.168.1.1